<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Le Labyrinthe Organic - RÃ¨gles du Jeu</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Firebase -->
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-analytics.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries
    
      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyBbZbUVYrAwj5V6cEX6085AcEFntdndKrw",
        authDomain: "rumblegus-baa3c.firebaseapp.com",
        databaseURL: "https://rumblegus-baa3c-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "rumblegus-baa3c",
        storageBucket: "rumblegus-baa3c.firebasestorage.app",
        messagingSenderId: "997502020604",
        appId: "1:997502020604:web:e39ae4f54422a35bfda079",
        measurementId: "G-1QGSHW3NEV"
      };
    
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
    </script>
</head>
<body>
    <!-- Barre de mode Ã©dition -->
    <div class="edit-mode-bar" id="editModeBar" style="display: none;">
        <button onclick="toggleEditMode()" id="exitEditModeBtn">âœ… Terminer l'Ã©dition</button>
        <button onclick="saveAllChanges()">ğŸ’¾ Sauvegarder les modifications</button>
        <button onclick="resetToDefault()">ğŸ”„ RÃ©initialiser</button>
    </div>

    <!-- Bouton pour activer le mode Ã©dition -->
    <button onclick="toggleEditMode()" id="enterEditModeBtn" style="position: fixed; bottom: 20px; right: 20px; z-index: 1000;">âœï¸ Mode Ã‰dition</button>

    <header>
        <h1>ğŸŒŒ Le Labyrinthe Organic</h1>
        <p class="subtitle">Un monde en perpÃ©tuel changement...</p>
    </header>

    <main>
        <section class="intro">
            <p>Bienvenue dans le Labyrinthe Organic, un monde en perpÃ©tuel changement. Chaque partie dÃ©bute dans une simple piÃ¨ce... et Ã  mesure que vous avancez, le monde s'Ã©tend, se dÃ©forme, et s'effondre.</p>
            <p>Le Labyrinthe est le cÅ“ur de toutes les aventures : peu importe le mode de jeu que vous allez choisir, ce sont ses rÃ¨gles simples qui faÃ§onnent la carte, les dÃ©placements, et les combats.</p>
        </section>

        <section class="rules-section">
            <h2>ğŸ”® Les types de cartes Map</h2>
            <div class="card-types">
                <div class="card-type" style="cursor: pointer;" onclick="openModal('modal-map-start')">
                    <div class="card-icon yellow">ğŸŸ¨</div>
                    <h3>Carte de dÃ©part</h3>
                    <p>LÃ  oÃ¹ les joueurs commencent, cette carte ne peut Ãªtre dÃ©truite.</p>
                </div>
                <div class="card-type" style="cursor: pointer;" onclick="openModal('modal-map-neutral')">
                    <div class="card-icon white">â¬œ</div>
                    <h3>Neutres</h3>
                    <p>PiÃ¨ces sans effet, servant Ã  construire le Labyrinthe.</p>
                </div>
                <div class="card-type" style="cursor: pointer;" onclick="openModal('modal-map-portal')">
                    <div class="card-icon portal">ğŸŒ€</div>
                    <h3>Portails</h3>
                    <p>Permettent de se tÃ©lÃ©porter Ã  n'importe quel autre portail visible sur la carte.</p>
                </div>
            </div>
        </section>

        <section class="rules-section">
            <h2>ğŸ§­ DÃ©roulement d'un tour</h2>
            <p>Le jeu se joue en tours individuels, dans le sens des aiguilles dâ€™une montre. Chaque joueur dispose de 3 Points dâ€™Action (PA) par tour.</p>
            <div class="actions">
                <div class="action">
                    <div class="action-icon">ğŸš¶</div>
                    <h4>DÃ©placement</h4>
                    <p>1 PA par case. Peut Ãªtre combinÃ© avec d'autres actions.</p>
                </div>
                <div class="action">
                    <div class="action-icon">âš”ï¸</div>
                    <h4>Combat</h4>
                    <p>1 PA pour attaquer. Les dÃ©gÃ¢ts dÃ©pendent de l'arme utilisÃ©e.</p>
                </div>
                <div class="action">
                    <div class="action-icon">ğŸ”„</div>
                    <h4>Utiliser un objet</h4>
                    <p>1 PA par objet. Certains objets ont des coÃ»ts variables.</p>
                </div>
            </div>
        </section>

        <section class="rules-section">
            <h2>ğŸ’ Items et Objets</h2>
            <div class="items-grid">
                <!-- Items de Combat -->
                <div class="item-card red" onclick="openModal('modal-item-dagger')">
                    <div class="item-icon">ğŸ”ª</div>
                    <h4>Dague</h4>
                    <p>Arme lÃ©gÃ¨re. +1 dÃ©gÃ¢t.</p>
                </div>
                <div class="item-card red" onclick="openModal('modal-item-sword')">
                    <div class="item-icon">âš”ï¸</div>
                    <h4>Ã‰pÃ©e</h4>
                    <p>Arme Ã©quilibrÃ©e. +2 dÃ©gÃ¢ts.</p>
                </div>
                <div class="item-card red" onclick="openModal('modal-item-bow')">
                    <div class="item-icon">ğŸ¹</div>
                    <h4>Arc</h4>
                    <p>Attaque Ã  distance. +1 dÃ©gÃ¢t, portÃ©e 2.</p>
                </div>

                <!-- Items de DÃ©placement -->
                <div class="item-card blue" onclick="openModal('modal-item-boots')">
                    <div class="item-icon">ğŸ‘Ÿ</div>
                    <h4>Bottes</h4>
                    <p>+1 case de dÃ©placement par tour.</p>
                </div>
                <div class="item-card blue" onclick="openModal('modal-item-grapnel')">
                    <div class="item-icon">ğŸª</div>
                    <h4>Grapnel</h4>
                    <p>Se dÃ©placer jusqu'Ã  3 cases en ligne droite.</p>
                </div>
                <div class="item-card blue" onclick="openModal('modal-item-teleport')">
                    <div class="item-icon">ğŸŒ€</div>
                    <h4>Portail de Poche</h4>
                    <p>TÃ©lÃ©portation vers n'importe quel portail.</p>
                </div>

                <!-- Items SpÃ©ciaux -->
                <div class="item-card purple" onclick="openModal('modal-item-potion')">
                    <div class="item-icon">ğŸ§ª</div>
                    <h4>Potion</h4>
                    <p>Restaure 2 PV.</p>
                </div>
                <div class="item-card purple" onclick="openModal('modal-item-bomb')">
                    <div class="item-icon">ğŸ’£</div>
                    <h4>Cocotte Minute</h4>
                    <p>Explose aprÃ¨s 1 tour. 2 dÃ©gÃ¢ts en zone 3x3.</p>
                </div>
                <div class="item-card purple" onclick="openModal('modal-item-shield')">
                    <div class="item-icon">ğŸ›¡ï¸</div>
                    <h4>Bouclier</h4>
                    <p>Bloque 1 dÃ©gÃ¢t pendant ce tour.</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Modales pour les cartes Map -->
    <div id="modal-map-start" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('modal-map-start')">&times;</span>
            <h2>ğŸŸ¨ Carte de DÃ©part</h2>
            <div class="modal-visual">
                <div class="grid-container">
                    <div class="grid-cell start">ğŸ‘¤</div>
                    <div class="grid-cell path"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell path"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell path"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell path"></div>
                    <div class="grid-cell"></div>
                </div>
            </div>
            <p><strong>Effet :</strong> Point de dÃ©part invulnÃ©rable. Les joueurs commencent ici et peuvent toujours y revenir.</p>
        </div>
    </div>

    <div id="modal-map-neutral" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('modal-map-neutral')">&times;</span>
            <h2>â¬œ Carte Neutre</h2>
            <div class="modal-visual">
                <div class="grid-container">
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell">â¬œ</div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                </div>
            </div>
            <p><strong>Effet :</strong> Aucune propriÃ©tÃ© spÃ©ciale. Peut Ãªtre dÃ©truite par des effets de jeu.</p>
        </div>
    </div>

    <div id="modal-map-portal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('modal-map-portal')">&times;</span>
            <h2>ğŸŒ€ Portail</h2>
            <div class="modal-visual">
                <div class="grid-container">
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell">ğŸŒ€</div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell player">ğŸ‘¤</div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                </div>
            </div>
            <p><strong>Effet :</strong> Permet de se tÃ©lÃ©porter vers n'importe quel autre portail visible sur la carte. CoÃ»t : 1 PA.</p>
        </div>
    </div>

    <!-- Modales pour les Items -->
    <div id="modal-item-dagger" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('modal-item-dagger')">&times;</span>
            <h2>ğŸ”ª Dague</h2>
            <div class="modal-visual">
                <div class="grid-container">
                    <div class="grid-cell player">ğŸ‘¤</div>
                    <div class="grid-cell arrow">â¡ï¸</div>
                    <div class="grid-cell enemy">ğŸ‘¹</div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell damage">ğŸ’¥ 1</div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                </div>
            </div>
            <p><strong>Effet :</strong> Arme lÃ©gÃ¨re infligeant 1 dÃ©gÃ¢t. Peut Ãªtre utilisÃ©e en combinaison avec d'autres actions.</p>
        </div>
    </div>

    <!-- Ajoutez ici les autres modales pour les items (Ã©pÃ©e, arc, bottes, etc.) -->
    <!-- Exemple pour l'Ã©pÃ©e -->
    <div id="modal-item-sword" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('modal-item-sword')">&times;</span>
            <h2>âš”ï¸ Ã‰pÃ©e</h2>
            <div class="modal-visual">
                <div class="grid-container">
                    <div class="grid-cell player">ğŸ‘¤</div>
                    <div class="grid-cell arrow">â¡ï¸</div>
                    <div class="grid-cell enemy">ğŸ‘¹</div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell damage">ğŸ’¥ 2</div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                </div>
            </div>
            <p><strong>Effet :</strong> Arme Ã©quilibrÃ©e infligeant 2 dÃ©gÃ¢ts. NÃ©cessite 1 PA.</p>
        </div>
    </div>

    <!-- Scripts pour les modales et Firebase -->
    <script>
        // Configuration Firebase (REMPLACEZ PAR VOS PROPRES CLÃ‰S)
        const firebaseConfig = {
            apiKey: "AIzaSyAYourApiKeyHere123456789",
            authDomain: "votre-projet.firebaseapp.com",
            databaseURL: "https://votre-projet.firebaseio.com",
            projectId: "votre-projet",
            storageBucket: "votre-projet.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcdef123456"
        };

        // Initialise Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Variables pour le mode Ã©dition
        let editMode = false;

        // Fonctions pour les modales
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Ferme la modale si on clique Ã  cÃ´tÃ©
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }

        // Mode Ã‰dition
        function toggleEditMode() {
            editMode = !editMode;
            if (editMode) {
                document.getElementById('editModeBar').style.display = 'flex';
                document.getElementById('enterEditModeBtn').style.display = 'none';
                enableEditing();
            } else {
                document.getElementById('editModeBar').style.display = 'none';
                document.getElementById('enterEditModeBtn').style.display = 'block';
                disableEditing();
            }
        }

        function enableEditing() {
            const editableElements = document.querySelectorAll(
                'p, h1, h2, h3, h4, .card-type p, .action p, .item-card p, .item-card h4, .modal p, .modal h2'
            );

            editableElements.forEach(el => {
                el.contentEditable = true;
                el.style.border = '1px dashed #ccc';
                el.style.padding = '5px';
                el.style.minHeight = '20px';
                el.style.backgroundColor = '#fffde7';
                el.style.borderRadius = '3px';
            });
        }

        function disableEditing() {
            const editableElements = document.querySelectorAll(
                '[contenteditable="true"]'
            );
            editableElements.forEach(el => {
                el.contentEditable = false;
                el.style.border = 'none';
                el.style.padding = '';
                el.style.backgroundColor = '';
            });
        }

        function saveAllChanges() {
            const allTextElements = document.querySelectorAll(
                'p, h1, h2, h3, h4, .card-type p, .action p, .item-card p, .item-card h4, .modal p, .modal h2'
            );

            let updates = {};
            allTextElements.forEach((el, index) => {
                const key = `text_${index}`;
                updates[`/customTexts/${key}`] = el.innerHTML;
            });

            database.ref().update(updates)
                .then(() => {
                    alert('âœ… Modifications sauvegardÃ©es dans Firebase !');
                    disableEditing();
                    toggleEditMode(); // DÃ©sactive le mode Ã©dition aprÃ¨s sauvegarde
                })
                .catch(error => alert('âŒ Erreur : ' + error.message));
        }

        function loadFromFirebase() {
            database.ref('/customTexts').once('value')
                .then(snapshot => {
                    const data = snapshot.val();
                    if (data) {
                        const allTextElements = document.querySelectorAll(
                            'p, h1, h2, h3, h4, .card-type p, .action p, .item-card p, .item-card h4, .modal p, .modal h2'
                        );

                        for (const key in data) {
                            const index = key.split('_')[1];
                            if (allTextElements[index]) {
                                allTextElements[index].innerHTML = data[key];
                            }
                        }
                    }
                })
                .catch(error => console.error('Erreur Firebase :', error));
        }

        function resetToDefault() {
            if (confirm('âš ï¸ ÃŠtes-vous sÃ»r de vouloir rÃ©initialiser tout le texte ?')) {
                database.ref('/customTexts').remove()
                    .then(() => {
                        location.reload();
                        alert('ğŸ”„ Texte rÃ©initialisÃ© avec succÃ¨s !');
                    })
                    .catch(error => alert('âŒ Erreur : ' + error.message));
            }
        }

        // Charge les donnÃ©es au dÃ©marrage
        window.addEventListener('DOMContentLoaded', loadFromFirebase);
    </script>
</body>
</html>
